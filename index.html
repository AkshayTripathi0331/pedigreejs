<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width,maximum-scale=2">

	<link href="https://code.jquery.com/ui/1.12.1/themes/cupertino/jquery-ui.css" rel="stylesheet" type="text/css" media="all" />
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css" media="all" />

	<style>
		.disabled {
		    color: grey;
		}
	</style>
</head>

<body>

<!-- HEADER -->
<div class="jumbotron" style="background-color:#DDD1C1">
	<div class="container">
	          <a class="btn btn-primary btn-lg pull-right" role="button" href="https://github.com/CCGE-BOADICEA/pedigreejs">View on GitHub</a>
	          <h1>pedigreejs</h1>
	          <h2>A web tool for building and displaying pedigrees.</h2>
	</div>
</div>

<div class="container">
	<div class="row">
<!-- EXAMPLE -->
		<div class="col-md-7 col-md-push-5">
			<div class="text-center">
				<label class="btn btn-default btn-file">
						<input id="load" type="file" style="display: none;"/>Load
				</label>	
				<label class="btn btn-default btn-file">
						<input id="save" type="button" style="display: none;"/>Save
				</label>
				<label class="btn btn-default btn-file">
						<input id="print" type="button" style="display: none;"/>Print
				</label>
				
				<div id="pedigrees"></div>
				<div id="node_properties"></div>
			</div>
		</div>
		<div class="col-md-5 col-md-pull-7">
			<h3>Overview</h3>
			<p class="text-justify">
			<strong>pedigreejs</strong> is a JavaScript library used to draw family trees using
			standard pedigree nomenclature. It uses <a href="https://d3js.org/">d3</a>
			to layout the hierarchical structure and draw the individual nodes as a SVG image.
			The size of the SVG can be configured as well as the colour codes used to denote disease.
			It can be used to build the pedigree structure or load in an existing data set.
			To assist visualisation and building of larger pedigrees a full screen mode is provided.
			</p>
			<h3>Current Limitations</h3>
			<ul>
				<li>The maximum number of partners an individual can have is 2.</li>
				<li>Consanguinity can not be represented.</li>
			</ul>
		</div>
	</div>

	<script src="https://code.jquery.com/jquery-3.1.0.min.js"></script> 
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.5.0/d3.min.js"></script>
	<script src="https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"></script>
	<script src="js/pedigree.js"></script>
	<script src="js/widgets.js"></script>
	<script src="js/pedigree_form.js"></script>
	<script src="js/undo_redo_refresh.js"></script>
	<script src="js/io.js"></script>

	<script type="text/javascript">
	var DEBUG = (pedigree_util.urlParam('debug') === null ? false : true);

	////////////////////
	var dataset = [
		{"name": "f11", "display_name": "Jane",  "sex": "F", "status": 1, "top_level": true, "breast_cancer":true, "ovarian_cancer":true},
		{"name": "m11", "sex": "M", "top_level": true},
		{"name": "f12", "sex": "F", "top_level": true, "breast_cancer":true},
		{"name": "m12", "sex": "M", "top_level": true},
		{"name": "m21", "sex": "M", "mother": "f11", "father": "m11"},
		{"name": "f21", "sex": "F", "mother": "f12", "father": "m12", "breast_cancer":true, "breast_cancer2": true, "ovarian_cancer":true, "pancreatic_cancer":true},
		{"name": "ch1", "display_name": "Ana", "sex": "F", "mother": "f21", "father": "m21", "proband": true}
	];
	$( "#pedigrees" ).append( $( "<div id='pedigree_history'></div>" ) );
	$( "#pedigrees" ).append( $( "<div id='pedigree'></div>" ) );
	
	var opts = {
			'targetDiv': 'pedigree',
			'btn_target': 'pedigree_history',
		//	'nodeclick': pedigree_form.nodeclick,
			'width': 390,
			'height': 280,
			'symbol_size': 30,
			'edit': true,
			'zoomIn': .8,
			'zoomOut': 3.,
        	'diseases': [{'type': 'breast_cancer', 'colour': '#F68F35'},
        				 {'type': 'breast_cancer2', 'colour': 'pink'},
						 {'type': 'ovarian_cancer', 'colour': '#4DAA4D'},
						 {'type': 'pancreatic_cancer', 'colour': '#4289BA'},
						 {'type': 'prostate_cancer', 'colour': '#D5494A'}],
			'DEBUG': (pedigree_util.urlParam('debug') === null ? false : true)};
	var local_dataset = pedcache.current(opts);
	if (local_dataset !== undefined && local_dataset !== null) {
		opts.dataset = local_dataset;
	} else {
		opts.dataset = dataset;
	}
	pbuttons.add(opts);
	opts= ptree.build(opts);
	
	</script>
<!-- EXAMPLE END -->
	
	<h3>Building Pedigrees</h3>
	<p>
	Individuals can be added to the pedigree by clicking on another individual and adding a
	partner <i class="fa fa-link" aria-hidden="true"></i> (two people with at least one child),
	parent <i class="fa fa-arrow-up" aria-hidden="true"></i>
	or sibling <i class="fa fa-arrow-down" aria-hidden="true"></i>.
	
	There are 'undo' <i class="fa fa-undo" aria-hidden="true"></i>,
	'redo' <i class="fa fa-repeat" aria-hidden="true"></i> and 'reset' <i class="fa fa-refresh" aria-hidden="true"></i>
	buttons at the top and a button to enable full screen editing <i class="fa fa-arrows-alt" aria-hidden="true"></i>.
	</p>
	
	<h3>Loading and Saving Pedigree Data</h3>
	<p>The pedigree can be saved out and loaded back in. BOADICEA file format (v4) can also be loaded in.</p>

	<h3>Configuration</h3>
	<p>The following parameters can be used to configure pedigreejs.</p>
	
<pre>
	var opts = {
		'targetDiv': 'pedigree',
		'btn_target': 'pedigree_history',
		'width': 450,
		'height': 320,
		'symbol_size': 35,
		'diseases': [
			{'type': 'breast_cancer', 'colour': '#F68F35'},
			{'type': 'ovarian_cancer', 'colour': '#4DAA4D'},
			{'type': 'pancreatic_cancer', 'colour': '#4289BA'},
			{'type': 'prostate_cancer', 'colour': '#D5494A'}],
		'DEBUG': (pedigree_util.urlParam('debug') === null ? false : true)
	};
	var local_dataset = pedcache.current(opts);
	if (local_dataset !== undefined && local_dataset !== null) {
		opts.dataset = local_dataset;
	} else {
		opts.dataset = dataset;
	}
	pbuttons.add(opts);
	opts= ptree.build(opts);
</pre>

	<div class="row">
		<div class="col-md-1"><strong>targetDiv</strong></div>
		<div class="col-md-11">This is the id of the HTML div used for drawing the pedigree, <i>e.g.</i> 'pedigree_edit'.</div>
	</div>
	<div class="row">
		<div class="col-md-1"><strong>btn_target</strong></div>
		<div class="col-md-11">This is the id of the HTML div used for the buttons, <i>e.g.</i> 'pedigree_history'.</div>
	</div>
	<div class="row">
		<div class="col-md-1"><strong>dataset</strong></div>
		<div class="col-md-11">The pedigree data to be displayed, <i>e.g.</i>
<pre>
[ {"name": "m21", "sex": "M", "top_level": true},
  {"name": "f21", "sex": "F", "top_level": true},
  {"name": "ch1", "sex": "F", "mother": "f21", "father": "m21", "breast_cancer":  true, "proband": true}]</pre>
    	</div>
    </div>
	<div class="row">
		<div class="col-md-1"><strong>width</strong></div>
		<div class="col-md-11">Width of the SVG element, <i>e.g.</i> 600.</div>
	</div>
	<div class="row">
		<div class="col-md-1"><strong>height</strong></div>
		<div class="col-md-11">Height of the SVG element, <i>e.g.</i> 400.</div>
    </div>
	<div class="row">
		<div class="col-md-1"><strong>symbol_size</strong></div>
		<div class="col-md-11">Size of the nodes, <i>e.g.</i> 35.</div>
    </div>
	<div class="row">
		<div class="col-md-1"><strong>zoomIn</strong></div>
		<div class="col-md-11">The factor by which the svg size can be scaled down to, default 1.</div>
    </div>
	<div class="row">
		<div class="col-md-1"><strong>zoomOut</strong></div>
		<div class="col-md-11">The factor by which the svg size can be scaled up to, default 1.</div>
    </div>
	<div class="row">
		<div class="col-md-1"><strong>edit</strong></div>
		<div class="col-md-11">Set to true for a button to display an individual's details (<i>e.g.</i> age, sex) in a dialog or provide a funtion to handle editing.</div>
    </div>
	<div class="row">
		<div class="col-md-1"><strong>diseases</strong></div>
		<div class="col-md-11">Diseases and their colour representation, <i>e.g.</i>
<pre>
[{'type': 'breast_cancer', 'colour': '#F68F35'},
 {'type': 'breast_cancer2', 'colour': 'pink'},
 {'type': 'ovarian_cancer', 'colour': '#4DAA4D'},
 {'type': 'pancreatic_cancer', 'colour': '#4289BA'},
 {'type': 'prostate_cancer', 'colour': '#D5494A'}]</pre>
		</div>
	</div>
	<div class="row">
		<div class="col-md-1"><strong>DEBUG</strong></div>
		<div class="col-md-11">Debug mode, <i>e.g.</i> false.</div>
    </div>
</div>
</body>

</html>
